
<script type="text/javascript">
  var feedbackSubmitted=false;
</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="javascript:postSubmit();"></iframe>
<form name="HelpFeedbackForm" onsubmit="javascript:submitClicked();" action="https://spreadsheets.google.com/spreadsheet/formResponse?formkey=dGdfUDdpTTVOVUFMbXFiYjJubHRLMGc6MQ&amp;ifq" method="POST" id="ss-form" target="hidden_iframe"> 
<hr/> 
<p class="SubHeading">How did you rate this page?</p> 
<style type="text/css">
	#rateMe{float:left; clear:both; width:100%; height:auto; padding:0px; margin-top:5px; margin-bottom:5px;}
	#rateMe li{float:left;list-style:none;}
	#rateMe li a:hover,
	#rateMe .on{background:url(../../Images/star_on.jpg) no-repeat;}
	#rateMe .hovered{background:url(../../Images/star_hover.jpg) no-repeat;}
	#rateMe a{float:left;background:url(../../Images/star_off.jpg) no-repeat;width:21px; height:21px;}
	.saved{color:red; }
</style>
<div id="rateMe"> 
<a onclick="setRating(this)" id="_1" title="Poor" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_2" title="Less poor" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_3" title="Average" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_4" title="Good" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_5" title="Excellent" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
</div>
<input type="hidden" name="entry.10.single" id="entry_10"></input>
<textarea name="entry.7.single" rows="4" cols="30" id="entry_7" onclick="javascript:clearDefaultComment();">Add additional comments.</textarea> 
<input type="hidden" name="entry.8.single" value="Autopopulate with page URL" id="entry_8">
<input type="hidden" name="entry.9.single" value="<medidata-product-name>" id="entry_9"/>
<br/>
<input type="hidden" name="pageNumber" value="0"> 
<input type="hidden" name="backupCache" value=""> 
<input type="submit" name="submit" id="submitControl" value="Submit" disabled="true" onclick="javascript:clearDefaultComment();"></form>
<script type="text/javascript">
var submitControl=document.getElementById('submitControl');
helpFeedBackForm=document.forms['ss-form'];
function enableSubmitButton()
{
submitControl.disabled=false;
}

function submitClicked()
{
feedbackSubmitted=true;
urlField=helpFeedBackForm.elements['entry_8'];
urlField.value=document.URL;
}

function postSubmit()
{
  if(feedbackSubmitted)
  {
    alert('Thank you for your feedback.');
	
	document.getElementById('entry_7').value="Add additional comments.";
	
	/*
	By passing a reference to currentRating to hoverOff(), and setting currentRating to null,
	we fool hoverOff() into switching off all the stars up to the current rating star.
	*/
	pretendHover = currentRating;
	currentRating = null;
	hoverOff(pretendHover);
	
	submitControl.disabled=true;
	
  }
}

function clearDefaultComment()
{
defaultCommentField=document.getElementById('entry_7');
if (defaultCommentField.value=="Add additional comments.")
  {
   defaultCommentField.value="";
  }
}

var sMax;	// Is the maximum number of stars
var currentRating; // Is the currentRating value onces a selection has been made

//Switch on/off stars depending on which one we're hovering over.
function hoverOver(hoveredOver){

    //Get the current rating.
	if(currentRating) {
	  curr = currentRating.id.replace("_", '');
	} else {
	  curr=0;
	}
	
	//Get the hovered-over star. 
	hov = hoveredOver.id.replace("_", ''); 
	
	//Set the hovered-over star to the hover graphic.
	document.getElementById("_"+hov).className = "hovered";
	
	//Note: if the hovered-over star (hov) is <= the current rating (curr), we don't need to do anything else.
	
	//If hov>curr, switch on all the stars between CR+1 and HS-1.
	for(i=parseInt(curr)+1; i<hov; i++) {
	  document.getElementById("_"+i).className = "on";
	}
	
	//Set the rating in the interface.
	//document.getElementById("rateStatus").value = hoveredOver.title;
	
}

//Switch on/off stars when the user moves away from the stars area or onto another star.
function hoverOff(exHover){ 

    //Get the hovered-over star and the current rating star.
	hov=exHover.id.replace("_",'');
	if(currentRating) {
	  curr=currentRating.id.replace("_",'');
	} else {
	  curr=0;
	}
	
	//Switch on all stars up to and including the current rating. 
	//Switch off all stars from current rating + 1 to the hovered-over star.
	//If there is no current rating this will switch off all the stars.
	for(i=1; i<=hov; i++) {
	
	  if(i<=curr) {
	    document.getElementById("_"+i).className="on";
	  } else {
	    document.getElementById("_"+i).className="";
	  }
	
	}
	
    
}

// Set the rating when the user clicks the star.
function setRating(clickedRating){
	
	//The clicked rating was previously hovered-over, so change its graphic to the graphic for the switched-on star.
	//The logic in hoverOver() has already switched on all the stars below the clicked rating.
	newrating = clickedRating.id.replace("_", ''); 
	document.getElementById("_"+newrating).className = "on";
	
	//Set the rating in the input field.
	document.getElementById("entry_10").value = newrating;
	
	//If the clicked rating (newrating) is lower than the previous rating (oldrating), switch off all the stars between newrating+1 and oldrating. 
	if(currentRating) {
	  oldrating=currentRating.id.replace("_",'');
	  
	  if(newrating < oldrating) {
	    for(i=parseInt(newrating)+1; i<=oldrating; i++) {
		 document.getElementById("_"+i).className = "";
		}
	  }
	}
	
	//Update the reference to the current rating to the rating just clicked.
	currentRating = clickedRating;
    
	submitControl.disabled = false;
		
}


</script>
</body>