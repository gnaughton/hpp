
<script type="text/javascript">
  var feedbackSubmitted=false;
</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="javascript:postSubmit();"></iframe>
<form name="HelpFeedbackForm" onsubmit="javascript:submitClicked();" action="https://spreadsheets.google.com/spreadsheet/formResponse?formkey=dGdfUDdpTTVOVUFMbXFiYjJubHRLMGc6MQ&amp;ifq" method="POST" id="ss-form" target="hidden_iframe"> 
<hr/> 
<p class="SubHeading">How do you rate this topic?</p> 
<style type="text/css">
	#starRating{float:left; clear:both; width:100%; height:auto; padding:0px; margin-top:5px; margin-bottom:5px;}
	#starRating li{float:left;list-style:none;}
	#starRating li a:hover,
	#starRating .on{background:url(../../Images/star_on.jpg) no-repeat;}
	#starRating .hovered{background:url(../../Images/star_hover.jpg) no-repeat;}
	#starRating .on_almost{background:url(../../Images/star_on_almost.jpg) no-repeat;}
	#starRating .hovered_almost{background:url(../../Images/star_hover_almost.jpg) no-repeat;}
	#starRating a{float:left;background:url(../../Images/star_off.jpg) no-repeat;width:21px; height:21px;}
	#starRating .rating_on{margin-left:5px;border-style:none;padding-top:4px;}
	#starRating .rating_almost{margin-left:5px;border-style:none;padding-top:4px;color:#979696;}
</style>
<div id="starRating"> 
<a onclick="setRating(this)" id="_1" title="Not useful" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_2" title="Somewhat useful" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_3" title="Useful" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_4" title="Very useful" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a> 
<a onclick="setRating(this)" id="_5" title="Just what I needed" onmouseover="hoverOver(this)" onmouseout="hoverOff(this)"></a>
<input type="text" class="rating_almost" id="ratingText"/>
</div>

<input type="hidden" name="entry.10.single" id="entry_10"></input>
<textarea name="entry.7.single" rows="2" cols="30" id="entry_7" onclick="javascript:clearDefaultComment();">Additional feedback/comments.</textarea> 
<input type="hidden" name="entry.8.single" value="Autopopulate with page URL" id="entry_8">
<input type="hidden" name="entry.9.single" value="<medidata-product-name>" id="entry_9"/>
<br/>
<input type="hidden" name="pageNumber" value="0"> 
<input type="hidden" name="backupCache" value=""> 
<input type="submit" name="submit" id="submitControl" style="margin-top:5px;" value="Submit" disabled="true" onclick="javascript:clearDefaultComment();"></form>
<script type="text/javascript">
var submitControl=document.getElementById('submitControl');
helpFeedBackForm=document.forms['ss-form'];
function enableSubmitButton()
{
submitControl.disabled=false;
}

function submitClicked()
{
feedbackSubmitted=true;
urlField=helpFeedBackForm.elements['entry_8'];
urlField.value=document.URL;
}

function postSubmit()
{
  if(feedbackSubmitted)
  {
    alert('Thank you for your feedback.');
	
	//Reset to default comments text.
	document.getElementById('entry_7').value="Additional feedback/comments.";
	
	//Clear the rating text.
	document.getElementById('ratingText').value="";
	
	//Get a reference to currentRating, set currentRating to null, then pass the reference to hoverOff().
	//This fools hoverOff() into switching off all the stars.
	pretendHover = currentRating;
	currentRating = null;
	hoverOff(pretendHover);
	
	submitControl.disabled=true;
	
  }
}

function clearDefaultComment()
{
defaultCommentField=document.getElementById('entry_7');
if (defaultCommentField.value=="Additional feedback/comments.")
  {
   defaultCommentField.value="";
  }
}

var currentRating; // Is the currentRating value onces a selection has been made

//Switch on/off stars depending on which one we're hovering over.
function hoverOver(hoveredOver){

    //Get the current rating.
	if(currentRating) {
	  curr = currentRating.id.replace("_", '');
	} else {
	  curr=0;
	}
	
	//Get the hovered-over star. 
	hov = hoveredOver.id.replace("_", ''); 
	
	/*
	  Stars that are 'almost' switched on are above the current rating and appear paler than 'on' stars.
	  This makes navigation over the stars clearer.
	  There are two 'almost' flavours: 'on' and 'hover'.
	  Example: if the current rating is 3 and the user hovers the mouse over star 5 the display is:
	  on | on | on | on_almost | hover_almost
	  Current rating: none, hover star 3:
	  on_almost | on_almost | hover_almost | off | off
	*/
	
	//Get the suffix that determines whether stars have 'almost' or 'on' format:
	if(hov>curr) {
	  style_suffix = "_almost";
	} else { 
	  style_suffix = "";
	}
	
	//Show the rating text in normal text if the user hovers over the current rating or light grey for any other rating.
	if(hov==curr) {
	  document.getElementById("ratingText").className="rating_on";
	} else {
	  document.getElementById("ratingText").className="rating_almost";
	}
	
	//Display the rating text in the UI.
	document.getElementById('ratingText').value=hoveredOver.title;
	
	//Set the hovered-over star to the hover graphic.
	document.getElementById("_"+hov).className = "hovered" + style_suffix;
	
	//Note: if the hovered-over star (hov) is <= the current rating (curr), we don't need to do anything else.
	
	//If hov>curr, switch on all the stars between CR+1 and HS-1.
	for(i=parseInt(curr)+1; i<hov; i++) {
	  document.getElementById("_"+i).className = "on" + style_suffix;
	}
}

//Switch on/off stars when the user moves away from the stars area or onto another star.
function hoverOff(exHover){ 

    //Get the hovered-over star and the current rating star.
	hov=exHover.id.replace("_",'');
	if(currentRating) {
	  curr=currentRating.id.replace("_",'');
	} else {
	  curr=0;
	}
	
	//Set the rating text to normal text weight if there is a rating.
	if(currentRating) {
	  document.getElementById("ratingText").className="rating_on";
	}
	
	
	//Update the rating text in the UI.
	if(currentRating) {
	  document.getElementById("ratingText").value=currentRating.title;
	} else {
	  document.getElementById("ratingText").value="";
	}
	
	//Switch on all stars up to and including the current rating. 
	//Switch off all stars from current rating + 1 to the hovered-over star.
	//If there is no current rating this will switch off all the stars.
	for(i=1; i<=hov; i++) {
	  if(i<=curr) {
	    document.getElementById("_"+i).className="on";
	  } else { 
	    document.getElementById("_"+i).className="";
	  }
	
	}
	
    
}

// Set the rating when the user clicks the star.
function setRating(clickedRating){
	
	
	//We need to switch on all the stars from the previous rating up to the clicked star with the "on" graphic.
	//(Currently these stars are in 'almost' state.)
	newrating = clickedRating.id.replace("_", ''); 
	if(currentRating) {
	 oldrating=currentRating.id.replace("_",'');
	} else {
	  oldrating=0;
	}
	
	//Find out how far up the list of stars we need to go.
	//(All stars above maxrating have already been switched off by hoverOff().)
	if (newrating>oldrating) {
	  maxrating=newrating;
	} else {
	  maxrating=oldrating;
	}
	
	for(i=1; i<=maxrating; i++ ) {
	
	  if(i<=newrating) {
	    //Switch on all stars up to the clicked star.
	    document.getElementById("_"+i).className = "on";
	  } else {
	    //Switch off all stars above the clicked star up to maxrating.
	   document.getElementById("_"+i).className = "";
	  }
	  
	}
	
	//Set the rating in the input field.
	document.getElementById("entry_10").value = newrating;
	
	//Make the rating text in the UI thicker by removing the light-grey colour style.
	document.getElementById("ratingText").className="rating_on";
	
	//Update the reference to the current rating to the rating just clicked.
	currentRating = clickedRating;
    
	//Enable the Submit button.
	submitControl.disabled = false;
		
}


</script>
</body>